!function(o){function n(o,n){var r=4*o._blocksize,i=r-n.length%r;return i}var r=o.pad={},i=function(o,n,r,i){var t=n.pop();if(0==t)throw new Error("Invalid zero-length padding specified for "+r+". Wrong cipher specification or key used?");var e=4*o._blocksize;if(t>e)throw new Error("Invalid padding length of "+t+" specified for "+r+". Wrong cipher specification or key used?");for(var p=1;t>p;p++){var c=n.pop();if(void 0!=i&&i!=c)throw new Error("Invalid padding byte of 0x"+c.toString(16)+" specified for "+r+". Wrong cipher specification or key used?")}};r.NoPadding={pad:function(o,n){},unpad:function(o,n){}},r.ZeroPadding={pad:function(o,n){var r=4*o._blocksize,i=n.length%r;if(0!=i)for(i=r-i;i>0;i--)n.push(0)},unpad:function(o,n){for(;0==n[n.length-1];)n.pop()}},r.iso7816={pad:function(o,r){var i=n(o,r);for(r.push(128);i>1;i--)r.push(0)},unpad:function(o,n){var r;for(r=4*o._blocksize;r>0;r--){var i=n.pop();if(128==i)return;if(0!=i)throw new Error("ISO-7816 padding byte must be 0, not 0x"+i.toString(16)+". Wrong cipher specification or key used?")}throw new Error("ISO-7816 padded beyond cipher block size. Wrong cipher specification or key used?")}},r.ansix923={pad:function(o,r){for(var i=n(o,r),t=1;i>t;t++)r.push(0);r.push(i)},unpad:function(o,n){i(o,n,"ANSI X.923",0)}},r.iso10126={pad:function(o,r){for(var i=n(o,r),t=1;i>t;t++)r.push(Math.floor(256*Math.random()));r.push(i)},unpad:function(o,n){i(o,n,"ISO 10126",void 0)}},r.pkcs7={pad:function(o,r){for(var i=n(o,r),t=0;i>t;t++)r.push(i)},unpad:function(o,n){i(o,n,"PKCS 7",n[n.length-1])}};var t=o.mode={},e=t.Mode=function(o){o&&(this._padding=o)};e.prototype={encrypt:function(o,n,r){this._padding.pad(o,n),this._doEncrypt(o,n,r)},decrypt:function(o,n,r){this._doDecrypt(o,n,r),this._padding.unpad(o,n)},_padding:r.iso7816};var p=t.ECB=function(){e.apply(this,arguments)},c=p.prototype=new e;c._doEncrypt=function(o,n,r){for(var i=4*o._blocksize,t=0;t<n.length;t+=i)o._encryptblock(n,t)},c._doDecrypt=function(o,n,r){for(var i=4*o._blocksize,t=0;t<n.length;t+=i)o._decryptblock(n,t)},c.fixOptions=function(o){o.iv=[]};var a=t.CBC=function(){e.apply(this,arguments)},d=a.prototype=new e;d._doEncrypt=function(o,n,r){for(var i=4*o._blocksize,t=0;t<n.length;t+=i){if(0==t)for(var e=0;i>e;e++)n[e]^=r[e];else for(var e=0;i>e;e++)n[t+e]^=n[t+e-i];o._encryptblock(n,t)}},d._doDecrypt=function(o,n,r){for(var i=4*o._blocksize,t=r,e=0;e<n.length;e+=i){var p=n.slice(e,e+i);o._decryptblock(n,e);for(var c=0;i>c;c++)n[e+c]^=t[c];t=p}};var f=t.CFB=function(){e.apply(this,arguments)},s=f.prototype=new e;s._padding=r.NoPadding,s._doEncrypt=function(o,n,r){for(var i=4*o._blocksize,t=r.slice(0),e=0;e<n.length;e++){var p=e%i;0==p&&o._encryptblock(t,0),n[e]^=t[p],t[p]=n[e]}},s._doDecrypt=function(o,n,r){for(var i=4*o._blocksize,t=r.slice(0),e=0;e<n.length;e++){var p=e%i;0==p&&o._encryptblock(t,0);var c=n[e];n[e]^=t[p],t[p]=c}};var u=t.OFB=function(){e.apply(this,arguments)},l=u.prototype=new e;l._padding=r.NoPadding,l._doEncrypt=function(o,n,r){for(var i=4*o._blocksize,t=r.slice(0),e=0;e<n.length;e++)e%i==0&&o._encryptblock(t,0),n[e]^=t[e%i]},l._doDecrypt=l._doEncrypt;var h=t.CTR=function(){e.apply(this,arguments)},y=h.prototype=new e;y._padding=r.NoPadding,y._doEncrypt=function(o,n,r){for(var i=4*o._blocksize,t=r.slice(0),e=0;e<n.length;){var p=t.slice(0);o._encryptblock(p,0);for(var c=0;e<n.length&&i>c;c++,e++)n[e]^=p[c];256==++t[i-1]&&(t[i-1]=0,256==++t[i-2]&&(t[i-2]=0,256==++t[i-3]&&(t[i-3]=0,++t[i-4])))}},y._doDecrypt=y._doEncrypt}(Crypto);
