!function(t){}("object"==typeof module?module.exports:window.Bitcoin={}),function(t){t.Base58={alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",validRegex:/^[1-9A-HJ-NP-Za-km-z]+$/,base:BigInteger.valueOf(58),encode:function(t){for(var r=BigInteger.fromByteArrayUnsigned(t),i=[];r.compareTo(e.base)>=0;){var n=r.mod(e.base);i.unshift(e.alphabet[n.intValue()]),r=r.subtract(n).divide(e.base)}i.unshift(e.alphabet[r.intValue()]);for(var o=0;o<t.length&&0==t[o];o++)i.unshift(e.alphabet[0]);return i.join("")},decode:function(t){for(var r=BigInteger.valueOf(0),i=0,n=t.length-1;n>=0;n--){var o=e.alphabet.indexOf(t[n]);if(0>o)throw"Invalid character";r=r.add(BigInteger.valueOf(o).multiply(e.base.pow(t.length-1-n))),"1"==t[n]?i++:i=0}for(var s=r.toByteArrayUnsigned();i-->0;)s.unshift(0);return s}};var e=t.Base58}("undefined"!=typeof Bitcoin?Bitcoin:module.exports),Bitcoin.Address=function(t){"string"==typeof t&&(t=Bitcoin.Address.decodeString(t)),this.hash=t,this.version=Bitcoin.Address.networkVersion},Bitcoin.Address.networkVersion=0,Bitcoin.Address.prototype.toString=function(){var t=this.hash.slice(0);t.unshift(this.version);var e=Crypto.SHA256(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0}),r=t.concat(e.slice(0,4));return Bitcoin.Base58.encode(r)},Bitcoin.Address.prototype.getHashBase64=function(){return Crypto.util.bytesToBase64(this.hash)},Bitcoin.Address.decodeString=function(t){var e=Bitcoin.Base58.decode(t),r=e.slice(0,21),i=Crypto.SHA256(Crypto.SHA256(r,{asBytes:!0}),{asBytes:!0});if(i[0]!=e[21]||i[1]!=e[22]||i[2]!=e[23]||i[3]!=e[24])throw"Checksum validation failed!";var n=r.shift();if(0!=n)throw"Version "+n+" not supported!";return r},Bitcoin.ECDSA=function(){function t(t,e,r,i){for(var n=Math.max(e.bitLength(),i.bitLength()),o=t.add2D(r),s=t.curve.getInfinity(),a=n-1;a>=0;--a)s=s.twice2D(),s.z=BigInteger.ONE,e.testBit(a)?s=i.testBit(a)?s.add2D(o):s.add2D(t):i.testBit(a)&&(s=s.add2D(r));return s}var e=EllipticCurve.getSECCurveByName("secp256k1"),r=new SecureRandom,i=null,n={getBigRandom:function(t){return new BigInteger(t.bitLength(),r).mod(t.subtract(BigInteger.ONE)).add(BigInteger.ONE)},sign:function(t,r){var i=r,o=e.getN(),s=BigInteger.fromByteArrayUnsigned(t);do var a=n.getBigRandom(o),u=e.getG(),p=u.multiply(a),c=p.getX().toBigInteger().mod(o);while(c.compareTo(BigInteger.ZERO)<=0);var g=a.modInverse(o).multiply(s.add(i.multiply(c))).mod(o);return n.serializeSig(c,g)},verify:function(t,r,i){var o,s;if(Bitcoin.Util.isArray(r)){var a=n.parseSig(r);o=a.r,s=a.s}else{if("object"!=typeof r||!r.r||!r.s)throw"Invalid value for signature";o=r.r,s=r.s}var u;if(i instanceof ec.PointFp)u=i;else{if(!Bitcoin.Util.isArray(i))throw"Invalid format for pubkey value, must be byte array or ec.PointFp";u=EllipticCurve.PointFp.decodeFrom(e.getCurve(),i)}var p=BigInteger.fromByteArrayUnsigned(t);return n.verifyRaw(p,o,s,u)},verifyRaw:function(t,r,i,n){var o=e.getN(),s=e.getG();if(r.compareTo(BigInteger.ONE)<0||r.compareTo(o)>=0)return!1;if(i.compareTo(BigInteger.ONE)<0||i.compareTo(o)>=0)return!1;var a=i.modInverse(o),u=t.multiply(a).mod(o),p=r.multiply(a).mod(o),c=s.multiply(u).add(n.multiply(p)),g=c.getX().toBigInteger().mod(o);return g.equals(r)},serializeSig:function(t,e){var r=t.toByteArraySigned(),i=e.toByteArraySigned(),n=[];return n.push(2),n.push(r.length),n=n.concat(r),n.push(2),n.push(i.length),n=n.concat(i),n.unshift(n.length),n.unshift(48),n},parseSig:function(t){var e;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if(e=2,2!=t[e])throw new Error("First element in signature must be a DERInteger");var r=t.slice(e+2,e+2+t[e+1]);if(e+=2+t[e+1],2!=t[e])throw new Error("Second element in signature must be a DERInteger");var i=t.slice(e+2,e+2+t[e+1]);e+=2+t[e+1];var n=BigInteger.fromByteArrayUnsigned(r),o=BigInteger.fromByteArrayUnsigned(i);return{r:n,s:o}},parseSigCompact:function(t){if(65!==t.length)throw"Signature has the wrong length";var r=t[0]-27;if(0>r||r>7)throw"Invalid signature type";var i=e.getN(),n=BigInteger.fromByteArrayUnsigned(t.slice(1,33)).mod(i),o=BigInteger.fromByteArrayUnsigned(t.slice(33,65)).mod(i);return{r:n,s:o,i:r}},recoverPubKey:function(r,o,s,a){a=3&a;var u=1&a,p=a>>1,c=e.getN(),g=e.getG(),y=e.getCurve(),h=y.getQ(),l=y.getA().toBigInteger(),d=y.getB().toBigInteger();i||(i=h.add(BigInteger.ONE).divide(BigInteger.valueOf(4)));var f=p?r.add(c):r,B=f.multiply(f).multiply(f).add(l.multiply(f)).add(d).mod(h),m=B.modPow(i,h),v=(m.isEven()?a%2:(a+1)%2,(m.isEven()?!u:u)?m:h.subtract(m)),b=new EllipticCurve.PointFp(y,y.fromBigInteger(f),y.fromBigInteger(v));b.validate();var A=BigInteger.fromByteArrayUnsigned(s),C=BigInteger.ZERO.subtract(A).mod(c),F=r.modInverse(c),S=t(b,o,g,C).multiply(F);if(S.validate(),!n.verifyRaw(A,r,o,S))throw"Pubkey recovery unsuccessful";var I=new Bitcoin.ECKey;return I.pub=S,I},calcPubkeyRecoveryParam:function(t,e,r,i){for(var n=0;4>n;n++)try{var o=Bitcoin.ECDSA.recoverPubKey(e,r,i,n);if(o.getBitcoinAddress().toString()==t)return n}catch(s){}throw"Unable to find valid recovery factor"}};return n}(),Bitcoin.KeyPool=function(){var t=function(){return this.keyArray=[],this.push=function(t){if(null!=t&&null!=t.priv){var e=!0;for(var r in this.keyArray){var i=this.keyArray[r];if(null!=i&&null!=i.priv&&t.getBitcoinAddress()==i.getBitcoinAddress()){e=!1;break}}e&&this.keyArray.push(t)}},this.reset=function(){this.keyArray=[]},this.getArray=function(){return this.keyArray.slice(0)},this.setArray=function(t){this.keyArray=t},this.length=function(){return this.keyArray.length},this.toString=function(){var t="# = "+this.length()+"\n",e=this.getArray();for(var r in e){var i=e[r];Bitcoin.Util.hasMethods(i,"getBitcoinAddress","toString")&&null!=i&&(t+='"'+i.getBitcoinAddress()+'", "'+i.toString("wif")+'"\n')}return t},this};return new t}(),Bitcoin.Bip38Key=function(){var t=function(t,e){this.address=t,this.priv=e};return t.prototype.getBitcoinAddress=function(){return this.address},t.prototype.toString=function(){return this.priv},t}(),Bitcoin.ECKey=function(){var t=Bitcoin.ECDSA,e=Bitcoin.KeyPool,r=EllipticCurve.getSECCurveByName("secp256k1"),i=function(n){if(n){if(n instanceof BigInteger)this.priv=n;else if(Bitcoin.Util.isArray(n))this.priv=BigInteger.fromByteArrayUnsigned(n);else if("string"==typeof n){var o=null;try{i.isWalletImportFormat(n)?o=i.decodeWalletImportFormat(n):i.isCompressedWalletImportFormat(n)?(o=i.decodeCompressedWalletImportFormat(n),this.compressed=!0):i.isMiniFormat(n)?o=Crypto.SHA256(n,{asBytes:!0}):i.isHexFormat(n)?o=Crypto.util.hexToBytes(n):i.isBase64Format(n)&&(o=Crypto.util.base64ToBytes(n))}catch(s){this.setError(s)}i.isBase6Format(n)?this.priv=new BigInteger(n,6):null==o||32!=o.length?this.priv=null:this.priv=BigInteger.fromByteArrayUnsigned(o)}}else{var a=r.getN();this.priv=t.getBigRandom(a)}this.compressed=void 0==this.compressed?!!i.compressByDefault:this.compressed;try{null!=this.priv&&0==BigInteger.ZERO.compareTo(this.priv)&&this.setError("Error: BigInteger equal to zero.");var u="FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364140",p=Crypto.util.hexToBytes(u),c=BigInteger.fromByteArrayUnsigned(p);null!=this.priv&&c.compareTo(this.priv)<0&&this.setError("Error: BigInteger outside of curve range."),null!=this.priv&&e.push(this)}catch(g){this.setError(g)}};return i.privateKeyPrefix=128,i.compressByDefault=!1,i.prototype.setError=function(t){return this.error=t,this.priv=null,this},i.prototype.setCompressed=function(t){return this.compressed=!!t,this.pubPoint&&(this.pubPoint.compressed=this.compressed),this},i.prototype.getPub=function(){return this.compressed?this.pubComp?this.pubComp:this.pubComp=this.getPubPoint().getEncoded(1):this.pubUncomp?this.pubUncomp:this.pubUncomp=this.getPubPoint().getEncoded(0)},i.prototype.getPubPoint=function(){return this.pubPoint||(this.pubPoint=r.getG().multiply(this.priv),this.pubPoint.compressed=this.compressed),this.pubPoint},i.prototype.getPubKeyHex=function(){return this.compressed?this.pubKeyHexComp?this.pubKeyHexComp:this.pubKeyHexComp=Crypto.util.bytesToHex(this.getPub()).toString().toUpperCase():this.pubKeyHexUncomp?this.pubKeyHexUncomp:this.pubKeyHexUncomp=Crypto.util.bytesToHex(this.getPub()).toString().toUpperCase()},i.prototype.getPubKeyHash=function(){return this.compressed?this.pubKeyHashComp?this.pubKeyHashComp:this.pubKeyHashComp=Bitcoin.Util.sha256ripe160(this.getPub()):this.pubKeyHashUncomp?this.pubKeyHashUncomp:this.pubKeyHashUncomp=Bitcoin.Util.sha256ripe160(this.getPub())},i.prototype.getBitcoinAddress=function(){var t=this.getPubKeyHash(),e=new Bitcoin.Address(t);return e.toString()},i.prototype.setPub=function(t){Bitcoin.Util.isArray(t)&&(t=Crypto.util.bytesToHex(t).toString().toUpperCase());var e=r.getCurve().decodePointHex(t);return this.setCompressed(e.compressed),this.pubPoint=e,this},i.prototype.getBitcoinWalletImportFormat=function(){var t=this.getBitcoinPrivateKeyByteArray();if(null==t)return"";t.unshift(i.privateKeyPrefix),this.compressed&&t.push(1);var e=Crypto.SHA256(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0});t=t.concat(e.slice(0,4));var r=Bitcoin.Base58.encode(t);return r},i.prototype.getBitcoinHexFormat=function(){return Crypto.util.bytesToHex(this.getBitcoinPrivateKeyByteArray()).toString().toUpperCase()},i.prototype.getBitcoinBase64Format=function(){return Crypto.util.bytesToBase64(this.getBitcoinPrivateKeyByteArray())},i.prototype.getBitcoinPrivateKeyByteArray=function(){if(null==this.priv)return null;for(var t=this.priv.toByteArrayUnsigned();t.length<32;)t.unshift(0);return t},i.prototype.toString=function(t){return t=t||"","base64"==t.toString().toLowerCase()||"b64"==t.toString().toLowerCase()?this.getBitcoinBase64Format():"wif"==t.toString().toLowerCase()?this.getBitcoinWalletImportFormat():this.getBitcoinHexFormat()},i.prototype.sign=function(e){return t.sign(e,this.priv)},i.prototype.verify=function(e,r){return t.verify(e,r,this.getPub())},i.decodeWalletImportFormat=function(t){var e=Bitcoin.Base58.decode(t),r=e.slice(0,33),n=Crypto.SHA256(Crypto.SHA256(r,{asBytes:!0}),{asBytes:!0});if(n[0]!=e[33]||n[1]!=e[34]||n[2]!=e[35]||n[3]!=e[36])throw"Checksum validation failed!";var o=r.shift();if(o!=i.privateKeyPrefix)throw"Version "+o+" not supported!";return r},i.decodeCompressedWalletImportFormat=function(t){var e=Bitcoin.Base58.decode(t),r=e.slice(0,34),n=Crypto.SHA256(Crypto.SHA256(r,{asBytes:!0}),{asBytes:!0});if(n[0]!=e[34]||n[1]!=e[35]||n[2]!=e[36]||n[3]!=e[37])throw"Checksum validation failed!";var o=r.shift();if(o!=i.privateKeyPrefix)throw"Version "+o+" not supported!";return r.pop(),r},i.isHexFormat=function(t){return t=t.toString(),/^[A-Fa-f0-9]{64}$/.test(t)},i.isWalletImportFormat=function(t){return t=t.toString(),128==i.privateKeyPrefix?/^5[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{50}$/.test(t):/^9[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{50}$/.test(t)},i.isCompressedWalletImportFormat=function(t){return t=t.toString(),128==i.privateKeyPrefix?/^[LK][123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{51}$/.test(t):/^c[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{51}$/.test(t)},i.isBase64Format=function(t){return t=t.toString(),/^[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789=+\/]{44}$/.test(t)},i.isBase6Format=function(t){return t=t.toString(),/^[012345]{99}$/.test(t)},i.isMiniFormat=function(t){t=t.toString();var e=/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{21}$/.test(t),r=/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{25}$/.test(t),i=/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{29}$/.test(t),n=Crypto.SHA256(t+"?",{asBytes:!0});return(0===n[0]||1===n[0])&&(e||r||i)},i}(),Bitcoin.Util={isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},makeFilledArray:function(t,e){for(var r=[],i=0;t>i;)r[i++]=e;return r},numToVarInt:function(t){return 253>t?[t]:65536>=t?[253,t>>>8,255&t]:1>=t?[254].concat(Crypto.util.wordsToBytes([t])):[255].concat(Crypto.util.wordsToBytes([t>>>32,t]))},valueToBigInt:function(t){return t instanceof BigInteger?t:BigInteger.fromByteArrayUnsigned(t)},formatValue:function(t){for(var e=this.valueToBigInt(t).toString(),r=e.length>8?e.substr(0,e.length-8):"0",i=e.length>8?e.substr(e.length-8):e;i.length<8;)i="0"+i;for(i=i.replace(/0*$/,"");i.length<2;)i+="0";return r+"."+i},parseValue:function(t){for(var e=t.split("."),r=e[0],i=e[1]||"0";i.length<8;)i+="0";i=i.replace(/^0+/g,"");var n=BigInteger.valueOf(parseInt(r));return n=n.multiply(BigInteger.valueOf(1e8)),n=n.add(BigInteger.valueOf(parseInt(i)))},sha256ripe160:function(t){return Crypto.RIPEMD160(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0})},dsha256:function(t){return Crypto.SHA256(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0})},hasMethods:function(t){for(var e,r=1;e=arguments[r++];)if("function"!=typeof t[e])return!1;return!0}};
